# MCP Server Configuration - Exposes Yaci Store data to AI agents
spring:
  ai:
    mcp:
      server:
        name: yaci-store-mcp-server
        version: 2.0.0
        type: SYNC
        instructions: "This server provides Cardano blockchain data access through Yaci Store. Use the available tools to query blocks, transactions, UTXOs, assets, epochs, staking pools, and accounts."
        capabilities:
          tool: true
          resource: false
          prompt: false
          completion: false

store:
  mcp-server:
    enabled: true

    # Tool category configuration
    # All tools are enabled by default (matchIfMissing=true in code)
    # Uncomment and set to false to disable specific tool categories
    tools:
      blocks:
        enabled: true
      transactions:
        enabled: true
      utxos:
        enabled: true
      assets:
        enabled: true
      epochs:
        enabled: true
      staking:
        enabled: true
      accounts:
        enabled: true
      adapot:
        enabled: true
      governance-aggr:
        enabled: true
      contract-aggr:
        enabled: true
      external-metadata:
        enabled: true

    # Aggregation configuration
    aggregation:
      enabled: true

      # Tier 1: Predefined aggregations (production-ready)
      predefined:
        enabled: true

      token-analytics:
        enabled: true
      # Token Holder Summary Materialized View
      token-holder-summary:
        enabled: true
        # Every 3 hours at minute 0 (12:00, 3:00, 6:00, 9:00)
        refresh-cron: "0 0 */3 * * *"

      # Address Credential Mapping Materialized View
      address-credential-mapping:
        enabled: true
        # Daily at 2:00 AM
        refresh-cron: "0 0 2 * * *"

      # Address Token Diversity Materialized View
      address-token-diversity:
        enabled: true
        # Every 12 hours at minute 0 (12:00 AM, 12:00 PM)
        refresh-cron: "0 0 */12 * * *"

      # Tier 2: Dynamic Query Builder (Flexible - For Power Users)
      # WARNING: This feature is powerful but requires careful use. Only enable in trusted environments.
      dynamic-query:
        enabled: true
        max-result-size: 10000          # Maximum result set size (rows)
        timeout-seconds: 30             # Query execution timeout
        max-joins: 3                    # Maximum number of JOINs allowed
        max-filters: 20                 # Maximum filter conditions (WHERE + HAVING)
        max-group-by: 10                # Maximum GROUP BY columns
        max-select-fields: 50           # Maximum SELECT fields

    dapp-registry:
      enabled: true
      external-registry:
        enabled: true  # Set to true to enable automatic sync from GitHub
        url: "https://raw.githubusercontent.com/Cardano-Fans/crfa-offchain-data-registry/main/dApps"
        schedule: "0 0 2 * * ?"  # Daily at 2 AM
        auto-merge: true  # Merge external DApps with local YAML (local takes precedence)
        timeout-seconds: 30
        fail-silently: true  # Log errors but don't crash on sync failures
      dapps:
        mainnet:
          # DEX Protocols
          - name: "masumi"
            display-name: "Masumi"
            category: "AI"
            description: "Masumi is a decentralized protocol empowering AI agents to collaborate seamlessly and monetize their services efficiently."
            script-addresses:
              - "addr1wx7j4kmg2cs7yf92uat3ed4a3u97kr7axxr4avaz0lhwdsq87ujx7"
            policy-ids:
              - "ad6424e3ce9e47bbd8364984bd731b41de591f1d11f6d7d43d0da9b9"
            contract-hashes:
              - "bd2adb685621e224aae7571cb6bd8f0beb0fdd31875eb3a27feee6c0"
        preprod:
          - name: "masumi"
            display-name: "Masumi"
            category: "AI"
            description: "Masumi is a decentralized protocol empowering AI agents to collaborate seamlessly and monetize their services efficiently."
            script-addresses:
              - "addr_test1wz7j4kmg2cs7yf92uat3ed4a3u97kr7axxr4avaz0lhwdsqukgwfm"
            policy-ids:
              - "7e8bdaf2b2b919a3a4b94002cafb50086c0c845fe535d07a77ab7f77"
            contract-hashes:
              - "bd2adb685621e224aae7571cb6bd8f0beb0fdd31875eb3a27feee6c0"
